name: ğŸ©º test

on:
  push:
  pull_request:

jobs:
  test_csp_command:
    runs-on: ubuntu-latest
    container:
      image: csplink/ubuntu_ci:22.04
    steps:
      - name: â¬‡ï¸ checkout csp_repo
        uses: actions/checkout@v3

      - name: â¬‡ï¸ install xmake
        uses: xmake-io/github-action-setup-xmake@v1

      - name: ğŸ©º test
        shell: bash
        run: | 
          export XMAKE_ROOT=y # Only need to use "--root" in CI
          xmake --version
          xmake csp --file=csplink.lua --get-hal=all -v
          pushd examples/sample_project
          export CSP_REPO=../../../csp_repo
          xmake csp -i
          popd
